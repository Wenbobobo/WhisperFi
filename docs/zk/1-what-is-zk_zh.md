# ZK 知识库：第一部分（修订版 v2）

## 什么是零知识证明？

零知识证明（ZKP）是一种密码学协议，它使**证明者（Prover）**能够在不泄露任何关于陈述本身的信息（除了其有效性之外）的情况下，让**验证者（Verifier）**相信某个特定的陈述是真实的。

这是一个具有深远意义的概念，对隐私和安全具有重大影响。它允许在不暴露数据本身的情况下对数据进行验证。

### ZKP 的三个属性

如果一个协议满足以下三个属性，那么它可以被认为是一个 ZKP：

1.  **完整性（Completeness）：** 如果陈述是真实的，并且证明者和验证者都遵守协议，那么验证者将被说服，相信陈述的真实性。
2.  **可靠性（Soundness）：** 如果陈述是虚假的，恶意的证明者无法说服诚实的验证者相信陈述是真实的（除非有非常小的、可以忽略不计的概率）。
3.  **零知识（Zero-Knowledge）：** 如果陈述是真实的，验证者除了知道陈述是真实的之外，不会学到任何其他信息。验证者不会学到证明者用来生成证明的任何秘密信息（“见证”）。

### 一个更正式的例子：图着色问题

想象一个有数百个节点的大型复杂图。如果可以用三种颜色（例如，红色、蓝色或绿色）中的一种为每个节点着色，使得没有两个相邻的节点具有相同的颜色，那么这个图就被称为“三色可着色”。

- **陈述：** “这个图是三色可着色的。”
- **秘密（见证）：** 图的实际有效着色方案。

证明者如何在不泄露着色方案本身的情况下，让验 �� 者相信他们有一个有效的三色着色方案？

以下是解决此问题的经典 ZKP 协议：

1.  **承诺（Commitment）：** 证明者拿到他们有效的三色着色方案，但在向验证者展示之前，他们会随机地置换颜色（例如，所有红色节点变为蓝色，所有蓝色节点变为绿色等）。然后，他们将每个着色后的节点放在一个上锁的盒子下面，并向验证者展示这一排上锁的盒子。
2.  **挑战（Challenge）：** 验证者随机选择图中的两个相邻节点，并要求证明者打开这两个节点的盒子。
3.  **回应（Response）：** 证明者打开所选的两个盒子，揭示这两个节点的颜色。

**验证：**

- 如果两个节点的颜色相同，证明立即失败。证明者是骗子。
- 如果两个节点的颜色不同，验证者就对证明者拥有有效的着色方案有了一定的信心。

**为什么这是零知识的？**

验证者只看到两个相邻节点的颜色。由于他们知道这两个节点是相邻的，他们期望颜色是不同的。证明者没有透露任何关于整体着色方案的信息。验证者无法将其与随机选择的两种不同颜色区分开来。

**可靠性与完整性：**

- **完整性：** 如果证明者有一个有效的着色方案，他们将始终能够满足验证者的挑战。
- **�� 靠性：** 如果证明者*没有*一个有效的着色方案，那么图中必须至少有一条边，其两个节点的颜色相同。证明者无法知道验证者会选择哪条边。如果验证者选择了那条边，证明者就会被抓住。通过多次重复这个协议，恶意证明者能够持续欺骗验证者的概率变得极小。

### ZKP 的类型

ZKP 主要有两种类型：

- **交互式 ZKP：** 这需要证明者和验证者在几轮中相互交互。上面的图着色示例就是一个交互式 ZKP。
- **非交互式 ZKP（NIZK）：** 这允许证明者在一步中生成证明，而无需与验证者进行任何交互。然后可以将证明发布出来，供任何人验证。NIZK 对于区块链应用来说更实用，因为它们不需要证明者和验证者同时在线。

### zk-SNARKs vs. zk-STARKs

在 NIZK 的类别中，区块链应用中常用的主要有两种类型的证明：**zk-SNARKs**和**zk-STARKs**。

- **zk-SNARKs（零知识简洁非交互式知识论证）：** 这些证明非常小，可以非常快速地进行验证。但是，它们需要一个可信的设置仪式来生成公共参数。
- **zk-STARKs（零知识可扩展透明知识论证）：** 这些证明比 zk-SNARKs 大，但它们不需要可信的设置。它们也更能抵抗量子计算机。

对于我们的协议，我们将使用**zk-SNARKs**，因为它们为我们的用例提供了性能和安全性的最佳组合。

在下一节中，我们将深入探讨我们用来构建这些证明的具体密码学组件：**承诺、无效符和默克尔树。**
